\input{./../header/kib.tex}
\input{./../header/user.tex}  

% TODO ! напишите здесь название вашей лекции
\title{Лекция 2. Теория вероятности}
% TODO ! замените на дату проведения этой лекции. Например \date{14 апреля 2019}
\date{24.11.2023}
% \logo{\href{https://t.me/kibinfo}{\includegraphics[width=.05\textwidth]{./../pic/kib_logo.png}}}
\author{Слипенчук Павел Владимирович}
\institute{\centering \includegraphics[width=.2\textwidth]{./../pic/kib_logo.png} \\ Москва,\\ \href{https://t.me/kibinfo}{\textbf{КИБ}} }
% \titlegraphic{\href{https://t.me/kibinfo}{\includegraphics[width=.05\textwidth]{./../pic/kib_logo.png}}}

% TODO ! замените https://github.com/kib-courses/latex_templates на ссылку ВАШЕГО спецкурса!
\titlegraphic{\small \href{https://github.com/kib-courses/dsis-math-base}{Базовая математическая подготовка для Data Science}}

\begin{document}
  \maketitle
    
  \begin{frame}{План лекции}\label{frame:plan}
  	% TODO ! добавте в план все ваши секции, кроме "Вопросы для самопроверки", "Домашнее задание" и "Список материалов"
    \begin{enumerate}
	% \item \nameref{section:why_combinatorics}
	\item \nameref{section:probability}
	\item \nameref{section:Bayes}
	
	\item \nameref{section:manipulations}

	\end{enumerate}
 \end{frame}

\begin{frame}{Важное замечание 1}
Лекция будет сильно упрощена, 
рассказана
<<на пальцах>>.

Задача: научится инженерно использовать теор.вероятности и не делать классических ошибок.

Мы не будем касаться определения теории вероятности по Колмогорову,
теорию меры,
$\sigma$-алгебру событий 
и т.д.

На это нет времени.

\end{frame}

\begin{frame}[fragile,t]{Важное замечание 2}
	
	\вопрос{Верно ли утверждение?:}
	\begin{equation*}
	a \cdot b = c ~\Longrightarrow~ a = \frac{b}{c}
	\end{equation*}
	
	
	
\end{frame}

\begin{frame}[fragile,t]{Важное замечание 2}
	
	\вопрос{Верно ли утверждение?:}
	\begin{equation*}
	a \cdot b = c ~\Longrightarrow~ a = \frac{b}{c}
	\end{equation*}
	
	Нет не верно!
	
	Правильно:
	\begin{equation*}
	a \cdot b = c ~\Longrightarrow~ a = \frac{b}{c} \vee (b=0 \wedge c =0)
	\end{equation*}
	
	Но... во всей лекции мы не будем такими занудами... :)
	
	
\end{frame}


    
  
\section{Зачем нужна теория вероятности в DS}\label{section:why_probability}
\begin{frame}
Теорвер

\begin{itemize}
\item основа основ для конструирования экспертных систем (ЭС), 
в частности ML алгоритмов.
\item 
\end{itemize}
\end{frame}

\section{Вероятность. Априорная и апостариорная веростности. Условная вероятность. Правило сложения и суммы}\label{section:probability}

\begin{frame}{Вероятность}
	Есть некий процесс, который всегда заканчивается определённым исходом : $a_1, ..., a_{n-1}$ или $a_n$.
	Будем эти исходы называть \termdef{событиями}.
	
	\termdef{Вероятность [события]} $P(a_i)$ -- это действительное число, обладающее следующими свойствами:
\begin{enumerate}
	\item $\forall a_i \in \left\{a_1, ..., a_n \right\} ~\Longrightarrow~ P(a_i) \in [0, 1]$
	\item $\forall b \notin \left\{a_1, ..., a_n \right\} ~\Longrightarrow~ P(b) = 0$
	\item $\sum_{i=1}^{i=n}\left(P(a_i)\right) = 1$
\end{enumerate}


\textbf{Замечание.}
В данном определении нет физического смысла понятия 
<<вероятность>>. Это просто некие числа, 
<<прикреплённые>> к событиям.
Они могут оказатся <<адекватными>> (насколько?)
или <<не адекватными>>.

\end{frame}

\begin{frame}{Вероятность. (Доп.слайд для зануд)}
\footnotesize
Вообще-то любое множество ${a_1, ..., a_n}$  
можно дополнить любым ${c_1, ..., c_m}$, 
таким что:
\begin{equation*}
	 \forall c \in \left\{c_1, ..., c_m \right\} ~\Longrightarrow~ P(c) = 0
\end{equation*}

Например $(a_1, a_2)$ -- это события, 
что [не мошенническая] монетка
упадёт орлом или решкой. Тогда $P(a_1) = P(a_2) = \frac{1}{2}$.

Мы можем дополнить событиями:
\begin{itemize}
	\item $c_1$ -- событие, что монета упадёт ребром;
	\item $c_2$ -- событие, что монета прилипнет к потолку;
	\item $c_3$ -- событие, что монета улетит в открытый космос и вообще не упадёт;
	\item ... \вопрос{ещё примеры?}
\end{itemize}

По этой причине первую формулу лучше определять не так:
\begin{equation*}
 \forall a_i \in \left\{a_1, ..., a_n \right\} ~\Longrightarrow~ P(a_i) \in [0, 1]
\end{equation*}
а так:
\begin{equation*}
\forall a_i \in \left\{a_1, ..., a_n \right\} ~\Longrightarrow~ P(a_i) \in (0, 1]
\end{equation*}

\end{frame}

\begin{frame}{Равновероятные события}
\small

События  $a_1, ..., a_n$ равновероятны по определению, если:
\begin{equation}
   P(a_1) = P(a_2) = ... = P(a_n)
\end{equation}

\дз{Докажите, что для равновероятных событий:}
\begin{equation}
 \forall a_i \in \left\{a_1, ..., a_n \right\} \rightarrow P(a_i) = \frac{1}{n}
\end{equation}

Примеры равновероятных событий:
\begin{itemize}
	\item выпадение орла или решки на монете (не мошеннической)
	\item зачатие\footnote{Не рождения. Например в Китае во время политики <<одна семья -- один ребёнок>> рождалось больше мальчиков. Почему?} мальчика и девочки
	\item выпадение 1, 2, 3, 4, 5 или 6 на игральном кубике (не мошенническом)
	\item \вопрос{ещё?}
\end{itemize}

\end{frame}

\begin{frame}{Априорная вероятность}
	
	\termdef{Априорная вероятность} -- число от 0 до 1, взятое из каких-либо умозаключений или правил.
	Примеры:
	\begin{enumerate}
		\item Вероятность выпадения орла 0.5, потому что он ничем не лучше и не хуже решки и монетка не может упасть ребром (это пренебрежимо мало)
		\item Мы отправили \term{событие} на вход ЭС и получили на выходе решение: "вероятность мошенничества равна 0.7 для данного события".
	\end{enumerate}
	
\end{frame}

\begin{frame}{Апостериорная вероятность}
	\small
	\termdef{Апостериорная вероятность} -- статистическая величина\footnote{
		Вообще то говоря, апостериорная вероятность имеет более глубокий и широкий смысл.
		Но в рамках нашего курса апостериорная вероятность -- это просто статистическая доля того или иного события.}, посчитанная на каких-либо конкретных данных.
	
	Примеры: 
	\footnotesize
	\begin{enumerate}
		\item Мы 100 раз подбросили монету и 47 раз выпал орёл. Следовательно 
		вероятность выпадения орла 0.47
		\item Мы взяли экспертную систему и посчитали, что \term{решение} "вероятность мошенничества 0.7"
		выпало на 67 мошеннических и 34 легитимных операций за определённое время. 
		Значит \term{точность} системы для данного \term{решения} на данном промежутке времени равна $\frac{67}{67+34} \approx 0.66$; что примерно равно $0.7$ -- следовательно систему можно считать адекватной.
	\end{enumerate}
\end{frame}

\begin{frame}{Совместные и несовместные события}


$P(AB)$ -- вероятность того, что произойдёт и А и B одновременно
(Так же обозначают как $P(A\bigcap B)$)

%\includegraphics[width=0.4\textwidth]{./../pic/pAB_diargramm.drawio.png}

\begin{itemize}
	\item $A$ и $B$ -- \termdef{совместные события}, если $P(AB) > 0$
	\item $A$ и $B$ -- \termdef{несовместные события}, если $P(AB) = 0$
\end{itemize}



\end{frame}
\begin{frame}{Условная вероятность}

$P(A|B)$ -- вероятность того, что произойдёт $A$, при условии что уже произошло $B$

$P(B|A)$ -- вероятность того, что произойдёт $B$, при условии, что уже произошло $A$

\дз{ДЗ. Почему верны формулы?:}
\begin{equation}\label{eq:P_A_by_B}
P(A|B) = \frac{P(AB)}{P(B)}
\end{equation}
\begin{equation}\label{eq:P_B_by_A}
P(B|A) = \frac{P(AB)}{P(A)}
\end{equation}

	
\end{frame}

\begin{frame}{Независимые события}
	
События $A$ и $B$ независимы, если 
наступление события $A$ никак не влияет на вероятность $B$,
а наступление события $B$ никак не влияет на $A$;
т.е на языке математики:
\begin{equation*}
P(A|B) = P(A)
\end{equation*}
\begin{equation*}
P(B|A) = P(B)
\end{equation*}

Для \textbf{независимых} событий из формул 
\eqref{eq:P_A_by_B} и \eqref{eq:P_B_by_A}
верно:
\begin{equation}
P(AB) = P(A) \cdot P(B)
\end{equation}

%\includegraphics[width=0.4\textwidth]{./../pic/pApB_independet_diargramm.drawio.png}

\end{frame}




\begin{frame}{Правило суммы и правило сложения}

 \termdef{Правило суммы}. Если $A$ и $B$ \term{несовместные} события, 
 то тогда вероятность того, что произойдёт хотя бы одно из событий:
 \begin{equation}\label{eq:rule_summ}
 P(A \vee B) = P(A) + P(B)
 \end{equation}

 \termdef{Правило умножения}. Если $A$ и $B$ \term{независимые} события, 
 то тогда вероятность того, что произойдёт хотя бы одно из событий:
 \begin{equation}\label{eq:rule_cdot}
 P(A B) = P(A) \cdot P(B)
 \end{equation}
 
 \дз{ДЗ. Почему формулы \eqref{eq:rule_summ} и \eqref{eq:rule_cdot} верны?}

\end{frame}

\begin{frame}{Вопросы на засыпку}
\дз{Подумайте дома, разбирая эту лекцию.}

Назовём \underline{три} события $A$, $B$, $C$ независимыми, если:
\begin{equation}
P (A B C) = P(A) \cdot P(B) \cdot P(C)
\end{equation}

Верны ли утверждения?
\begin{enumerate}
	\item Если $A$, $B$, $C$ -- независимы, то они все пары из них -- независимы
	\item Если $A$, $B$, $C$ -- независимы, то есть хотя бы одна пара независимых событий
	\item Если любая пара из ${A, B, C}$ -- независимы, то все три $A, B, C$ -- независимы.
\end{enumerate}

\end{frame}


\section{Формула Байеса}\label{section:Bayes}

\begin{frame}
\textbf{То́мас Ба́йес}
(Thomas Bayes; \textbf{1702 -- 1761}) 
— английский математик, священник. 
Член Лондонского королевского общества.
	
\begin{equation}\label{eq:Bayes}
P(A|B) = \frac{P(B|A) \cdot P(A)}{P(B)}
\end{equation}

$\blacktriangleleft$
Из формул \eqref{eq:P_A_by_B} и \eqref{eq:P_B_by_A}
получаем:
\begin{equation*}
P(A|B)P(B) = P(AB) = P(B|A) P(A)
\end{equation*}
откуда получаем \eqref{eq:Bayes}.
$\blacktriangleright$


\end{frame}




\section{Манипуляции в теории вероятности}\label{section:manipulations}
\begin{frame}{Задача о двух конвертах}

Есть два конверта с деньгами.
В один конверт помещают какую-то сумму денег,
сколько именно -- не известно. 
Во второй -- в два раза больше.

Вам и вашему партнёру дали по конверту, 
выбор конвертов происходил равновероятно.

Вы открыли конверт и обнаружили в нём X рублей.
Сколько у вашего партнёра -- вам не известно.
Выгодно ли вам с ним поменятся?


\end{frame}

\begin{frame}{Задача о двух конвертах. Наивное решение}

У вашего партнёра либо 2X рублей, либо
$\frac{X}{2}$ рублей. Эти исходы равновероятны.

Следовательно если вы обменяете конверты, то в среднем получите:
\begin{equation}\label{eq:envelopes}
	\frac{1}{2}\cdot2X + \frac{1}{2}\cdot\frac{X}{2}=\frac{5}{4}X	
\end{equation}

Но ведь и ваш партнёр думает так же! 
Следовательно вам обоим ВЫГОДНО поменять конверт.
Но так быть не может.

Где ошибка в формуле \eqref{eq:envelopes}?
\end{frame}

\begin{frame}{Задача о двух конвертах. Манипуляция}

Манипуляция: 
<<В один конверт помещают какую-то сумму денег,
сколько именно -- не известно.>>

В мире напечатано очень много, но ОГРАНИЧЕННОЕ 
количество денег.
Их не может быть бесконечно много.

На самом деле, кроме вас и партнёра есть ещё спонсор.
Наколько этот он богат?
Он не может быть <<бесконечно богатым>>.

(...)
\end{frame}

\begin{frame}{Задача о двух конвертах. Решение}
\small
(...)

Правильно написать так:
спонсор для обоих конвертов с вероятностью $P(Y)$ берёт $Y$ денег,
тогда верно
\begin{equation}
\sum_{\forall X=1}^{X=N} P(Y) = 1
\end{equation}
где $N$ -- максимальная сумма денег у спонсора	

Тогда в первом конверте с вероятностью $P(Y)$ имеем $\frac{1}{3}Y$ денег,
а во втором $\frac{2}{3}Y$ денег.
\дз{Можем построить соотвествующие графики для обоих конвертов.}


Если у вас $X$ денег,
вы должны посмотреть на графики (домашнее задание)
и вычислить выгоду.

\дз{
В качестве домашнего задания. Пусть Y c шагом в 300 рублей равновероятно может быть {300, 600, ..., 30000}.
Решите задачу, написав код на Python}
	



\end{frame}


\section{Домашняя работа}

\begin{frame}{Чтобы не быть обезьяной...}
	
Прочитать неспешно
(можно по одному расслабленному вечеру на пункт)
\begin{enumerate}
	\item \url{https://ru.wikipedia.org/wiki/История_теории_вероятностей}
\end{enumerate}

\end{frame}


\section{Список материалов}

\begin{frame}

TODO
%Методичка: <<Элементы комбинаторики>> (А.Е.Жуков, Д.А.Жуков, 2014)

%Калкулятор биномиальных коэфициентов: \url{https://www.omnicalculator.com/math/binomial-coefficient}

%Стандартная библиотека Python itertools: \url{https://docs.python.org/3/library/itertools.html}

\end{frame}

  
\end{document}